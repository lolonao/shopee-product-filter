# 開発手順

このドキュメントは、`shopee-product-filter` プロジェクトにおける開発の標準的な手順を説明します。

## 1. 開発の開始とタスクの分割

大きな機能追加や改修に着手する際は、まずそのタスク全体を把握し、実行可能な小さな単位に分割します。

### 1.1. タスクの特定と概要把握

-   実装したい機能や解決したい課題の全体像を把握します。

### 1.2. タスクの分解とTODOリストの作成

-   特定したタスクを、GitHub Issueとして管理できる粒度（通常、1つのIssueが1つのフィーチャーブランチで完結できる程度）に分解します。
-   分解したタスクは、必要に応じて `TODO.md` のようなファイルにリストアップし、作業の全体像と順序を明確にします。
    -   *例: DBスキーマ変更、Streamlit UI更新、データベース再作成といった一連の作業を、それぞれ独立したIssueとして定義する。*
-   **TODO.md の運用:**
    -   `TODO.md` は、Naoさんとジーナの間の共通認識ツールとして活用します。
    -   **タスクの開始前と完了後には、必ず `TODO.md` を確認し、進捗状況を更新してください。**
    -   完了したタスクは `[x]` でマークし、必要に応じて履歴として残すか、定期的にアーカイブしてください。

### 1.3. GitHub Issueの作成

-   分解した各タスクに対して、GitHub Issues に新しいIssueを作成します。
-   Issueのタイトルは簡潔に、本文には目的、具体的な作業内容、完了条件を明確に記述します。

## 2. 開発環境のセットアップ (初回のみ)

プロジェクトをクローンした後、以下のコマンドをプロジェクトのルートディレクトリで実行し、編集可能な状態でインストールします。これにより、Pythonがプロジェクト内のモジュールを正しく見つけられるようになり、コードの変更が即座に反映されます。

```bash
uv pip install -e .
```

## 3. Issueベースの開発ワークフロー

GitHub Issues で作成された各Issueに沿って作業を進めます。

### 3.1. Issueの確認と選択

-   GitHubの [Issues](https://github.com/lolonao/shopee-product-filter/issues) を確認し、次に着手するIssueを選択します。
-   Issueの目的、作業内容、完了条件をよく理解します。

### 3.2. 新しいブランチの作成

-   作業を開始する前に、必ず `develop` ブランチから新しいフィーチャーブランチを作成します。ブランチ名は、Issueの内容がわかるように命名します（例: `feat/issue-6-db-schema-optimization`）。

    ```bash
    # develop ブランチにいることを確認
git checkout develop

    # 最新の状態に更新 (任意)
git pull origin develop

    # 新しいフィーチャーブランチを作成し、切り替える
git checkout -b feat/issue-6-db-schema-optimization
    ```

### 3.3. コードの変更と実装

-   作成したフィーチャーブランチ上で、Issueに記載された作業内容に従ってコードを変更・実装します。
-   変更は、Issueの目的と完了条件を満たすように行います。

### 3.4. ローカルでの動作確認

-   コードの変更後、必ずローカル環境で動作確認を行います。
-   **特に、Issueの完了条件に記載されている内容を重点的に確認します。**
-   FastAPIサーバーやStreamlitアプリケーションの起動、機能テストなど、変更が正しく機能することを確認します。
-   必要に応じて、`uv run pytest` などでテストを実行します。

### 3.5. 変更のコミット

-   動作確認が完了したら、変更をコミットします。
-   コミットメッセージは、[Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) 規約に従い、変更内容を簡潔かつ明確に記述します。
    -   例: `feat: DBスキーマ最適化 (FastAPIモデル更新)`
    -   例: `fix: Streamlitアプリのインポートエラー修正`

    ```bash
    # 変更をステージング
git add .

    # コミット
git commit -m "feat: Issueのタイトル

Issueの本文の要約

Closes #Issue番号"
    ```

### 3.6. リモートへのプッシュ

-   コミット後、フィーチャーブランチをリモートリポジトリにプッシュします。

    ```bash
git push origin feat/issue-6-db-schema-optimization
    ```

### 3.7. プルリクエスト (PR) の作成

-   GitHub上で、作成したフィーチャーブランチから `develop` ブランチへのプルリクエストを作成します。
-   PRのタイトルと説明文は、Issueの内容と関連付け、変更の目的と内容が明確にわかるように記述します。
-   関連するIssueをPRの本文にリンクします（例: `Closes #6`）。

### 3.8. コードレビューとマージ

-   作成したPRに対してコードレビューを依頼します。
-   レビューで指摘された点があれば修正し、再度プッシュします。
-   レビューが承認されたら、`develop` ブランチにマージします。

### 3.9. Issueのクローズ

-   PRが `develop` ブランチにマージされたら、関連するGitHub Issueをクローズします。

## 5. ドキュメントの更新と整理

-   機能追加や変更に伴い、関連するドキュメント（例: `README.md`, `アプリ仕様書.md`, `起動方法.md` など）を適宜更新します。
-   特に、新しい機能や変更された機能の利用方法、設定方法などを明確に記述します。
-   不要になったドキュメント（例: 過去のデバッグノートなど）は、`docs/archive` ディレクトリに移動するなどして整理します。